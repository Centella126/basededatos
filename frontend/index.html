<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Resumen Financiero</title>
  <script>
    if (sessionStorage.getItem('isAuthenticated') !== 'true') {
      window.location.replace('login.html');
    }
  </script>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="icono.png">
  <link rel="manifest" href="manifest.json">
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1><i data-lucide="bar-chart-3"></i> Finanzas Gema</h1>
    <button id="logout-btn" class="option-btn danger">
      <i data-lucide="log-out"></i><span class="logout-text">&nbsp;Salir</span>
    </button>
  </header>

  <nav class="tabs">
    <button class="tab-btn active" data-tab="resumen">Resumen</button>
    <button class="tab-btn" data-tab="agregar">Agregar</button>
    <button class="tab-btn" data-tab="modificar">Modificar</button>
    <button class="tab-btn" data-tab="eliminar">Eliminar</button>
    <button class="tab-btn" data-tab="consultas">Consultas</button>
    <button class="tab-btn" data-tab="reportes">Reportes</button>
  </nav>
  <button id="fab-menu" class="fab-menu" aria-label="Abrir menú de navegación">
    <i data-lucide="menu"></i>
  </button>
  <div id="mobile-menu-overlay" class="mobile-menu-overlay hidden"></div>
  <div id="mobile-bottom-sheet" class="mobile-bottom-sheet hidden">
    <nav class="mobile-nav">
      <button class="mobile-nav-btn" data-tab="resumen"><i data-lucide="bar-chart-3"></i> Resumen</button>
      <button class="mobile-nav-btn" data-tab="agregar"><i data-lucide="plus-circle"></i> Agregar</button>
      <button class="mobile-nav-btn" data-tab="modificar"><i data-lucide="edit"></i> Modificar</button>
      <button class="mobile-nav-btn" data-tab="eliminar"><i data-lucide="trash-2"></i> Eliminar</button>
      <button class="mobile-nav-btn" data-tab="consultas"><i data-lucide="search"></i> Consultas</button>
      <button class="mobile-nav-btn" data-tab="reportes"><i data-lucide="line-chart"></i> Reportes</button>
    </nav>
  </div>

  <main class="container">
    <section class="tab-content active" id="resumen">
      <div class="grid">
        <div class="card"><h2>Total Ventas</h2><p class="value" id="totalVentas"></div>
        <div class="card"><h2>Total Abonos</h2><p class="value" id="totalAbonos"></div>
        <div class="card"><h2>Por Cobrar</h2><p class="value" id="totalPorCobrar"></div>
        <div class="card"><h2>Invertido en Productos</h2><p class="value" id="totalInvertidoEnProductos"></div>
        
        <div class="card">
          <h2>Ganancia</h2>
          <div class="value-with-action">
              <p class="value" id="totalGananciaPorDia">$0.00</p>
              <button id="btnRetirarGanancia" class="option-btn success" title="Retirar Ganancia del Día">
                  <i data-lucide="download"></i>
              </button>
          </div>
        </div>

        <div class="card card-actions">
          <button class="option-btn" id="actionAddVenta"><i data-lucide="shopping-cart"></i> Venta</button>
          <button class="option-btn" id="actionAddAbono"><i data-lucide="dollar-sign"></i> Abono</button>
        </div>
          
      </div>

      <div class="resumen-actions-row">
        <button id="refresh" class="option-btn" title="Actualizar"><i data-lucide="refresh-cw"></i></button>
        <div style="flex:1"></div>
        <button id="openWhatsappModal" class="option-btn whatsapp-btn" title="Enviar Saldos"><i data-lucide="message-circle"></i></button>
      </div>
    </section>

    <section class="tab-content" id="agregar">
      <h2>Agregar</h2>
      <div class="options-grid">
        <button class="option-btn" id="openAddAbono"><i data-lucide="plus-circle"></i> Agregar Abono</button>
        <button class="option-btn" id="openAddProduct"><i data-lucide="plus-circle"></i> Agregar Producto</button>
        <button class="option-btn" id="openAddVenta"><i data-lucide="plus-circle"></i> Agregar Venta</button>
        <button class="option-btn" id="openAddClient"><i data-lucide="plus-circle"></i> Agregar Cliente</button>
      </div>
    </section>

    <section class="tab-content" id="modificar">
      <h2>Modificar</h2>
      <div class="options-grid">
        <button class="option-btn warning" id="openModifyAbono"><i data-lucide="edit"></i> Modificar Abono</button>
        <button class="option-btn warning" id="openModifyProducto"><i data-lucide="edit"></i> Modificar Producto</button>
        <button class="option-btn warning" id="openModifyVenta"><i data-lucide="edit"></i> Modificar Venta</button>
        <button class="option-btn warning" id="openModifyCliente"><i data-lucide="edit"></i> Modificar Cliente</button>
      </div>
    </section>

    <section class="tab-content" id="eliminar">
      <h2>Eliminar</h2>
      <div class="options-grid">
        <button class="option-btn danger" id="openDeleteAbono"><i data-lucide="trash-2"></i> Eliminar Abono</button>
        <button class="option-btn danger" id="openDeleteProducto"><i data-lucide="trash-2"></i> Eliminar Producto</button>
        <button class="option-btn danger" id="openDeleteVenta"><i data-lucide="trash-2"></i> Eliminar Venta</button>
        <button class="option-btn danger" id="openDeleteCliente"><i data-lucide="trash-2"></i> Eliminar Cliente</button>
      </div>
    </section>

    <section class="tab-content" id="consultas">
      <h2>Consultas</h2>
      <div class="options-grid">
        <button class="option-btn" id="btn-open-consulta-clientes"><i data-lucide="search"></i> Clientes</button>
        <button class="option-btn" id="btn-open-consulta-productos"><i data-lucide="package-search"></i> Productos Disponibles</button>
        <button class="option-btn" id="btn-open-consulta-ventas"><i data-lucide="search"></i> Historial de Ventas</button>
      </div>
    </section>

    <section class="tab-content" id="reportes">
    <div class="consulta-header">
      <h2><i data-lucide="line-chart"></i> Reportes</h2>
      <div class="reportes-filtros">
        <label for="reportes-month-filter">Seleccionar Mes:</label>
        <input type="month" id="reportes-month-filter">
        <button id="refresh-reportes" class="option-btn"><i data-lucide="refresh-cw"></i> Actualizar</button>
      </div>
    </div>

    <div class="grid kpi-grid">
      <div class="card kpi-full"><h2>Total Invertido</h2><p class="value" id="kpi-total-invertido"></div>
      <div class="card kpi-full"><h2>Ventas Totales</h2><p class="value" id="kpi-total-ventas"></div>
      <div class="card kpi-full"><h2>Categoría Estrella</h2><p class="value" id="kpi-categoria-estrella"></div>
      <div class="card kpi-full"><h2>Producto Más Rentable</h2><p class="value" id="kpi-producto-rentable"></div>
    </div>

    <div class="card">
    <h2><i data-lucide="activity"></i> Análisis Rápido</h2>
    <div class="analisis-grid">
      <div class="analisis-item">
        <h3><i data-lucide="alert-triangle" class="icon-warning"></i> Categorías con Ventas &lt; Inversión</h3>
        <ul id="analisis-categorias-riesgo"><li>Cargando...</li></ul>
      </div>
      <div class="analisis-item">
        <h3><i data-lucide="trending-down" class="icon-danger"></i> Productos con Ventas Bajas</h3>
        <ul id="analisis-productos-bajos"><li>Cargando...</li></ul>
      </div>
      <div class="analisis-item">
        <h3><i data-lucide="star" class="icon-success"></i> Productos Top en Ventas</h3>
        <ul id="analisis-productos-top"><li>Cargando...</li></ul>
      </div>
      <div class="analisis-item">
        <h3><i data-lucide="users" class="icon-info"></i> Clientes con Mayor Adeudo</h3>
        <ul id="analisis-clientes-adeudo"><li>Cargando...</li></ul>
      </div>
    </div>
    </div>

    <div class="card">
      <h2><i data-lucide="bar-chart-2"></i> Gráficas</h2>
      <div class="chart-wrapper active" id="ventasVsInversionChart-wrapper">
        <canvas id="ventasVsInversionChart"></canvas>
      </div>
    </div>

    </section>

    <section class="tab-content" id="consulta-clientes-view">
      <div class="consulta-header">
          <h2><i data-lucide="user-check"></i> Consulta de Clientes</h2>
          <button class="option-btn" id="btn-volver-consultas"><i data-lucide="arrow-left"></i> Volver</button>
      </div>
      
      <div class="card">
          <label for="selectConsultaCliente">Selecciona un Cliente:</label>
          <select id="selectConsultaCliente" name="cliente_id"></select>
      </div>

      <div id="cliente-detalle-info" class="hidden">
          <div class="cliente-detalle-wrapper">
            <div class="cliente-detalle-col izq">
              <div class="card datos-personales">
                <h3>Datos Personales</h3>
                <p><strong>Nombre:</strong> <span id="detalle-nombre">--</span></p>
                <p><strong>Teléfono:</strong> <span id="detalle-telefono">--</span></p>
                <p><strong>Domicilio:</strong> <span id="detalle-domicilio">--</span></p>
              </div>
            </div>
            <div class="cliente-detalle-col der">
              <div class="card resumen-financiero">
                <div class="resumen-grid">
                  <div class="resumen-col-izq">
                    <div class="sub-card"><h4>Total Comprado</h4><p class="value" id="detalle-comprado">$0.00</p></div>
                    <div class="sub-card"><h4>Total Abonado</h4><p class="value" id="detalle-abonado">$0.00</p></div>
                  </div>
                  <div class="resumen-col-der">
                    <div class="sub-card" id="saldo-card">
                      <h4 id="detalle-saldo-titulo">Saldo Deudor</h4>
                      <p class="value" id="detalle-saldo">$0.00</p>
                    </div>
                    <div class="sub-card grafica-ventas-abonos" style="display: flex; align-items: center; justify-content: center;">
                      <canvas id="grafica-ventas-abonos" width="140" height="70"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
              <div class="historial-grid">
                  <div>
                      <h3><i data-lucide="shopping-cart"></i> Historial de Ventas</h3>
                      <div class="table-container">
                          <table id="tabla-historial-ventas">
                              <thead>
                                  <tr><th>Fecha</th><th>Producto</th><th>Cant.</th><th>P. Unit.</th><th>Subtotal</th></tr>
                              </thead>
                              <tbody></tbody>
                          </table>
                      </div>
                  </div>
                  <div>
                      <h3><i data-lucide="dollar-sign"></i> Historial de Abonos</h3>
                      <div class="table-container">
                          <table id="tabla-historial-abonos">
                              <thead>
                                  <tr><th>Fecha</th><th>Monto</th></tr>
                              </thead>
                              <tbody></tbody>
                          </table>
                      </div>
                  </div>
              </div>
          </div>
      </div>
    </section>

    <section class="tab-content" id="consulta-productos-view">
      <div class="consulta-header">
          <h2><i data-lucide="package-search"></i> Consulta de Productos Disponibles</h2>
          <button class="option-btn" id="btn-volver-consultas-desde-productos"><i data-lucide="arrow-left"></i> Volver</button>
      </div>

      <div class="card card-filtros">
          <div class="filtro-item">
              <label for="filtroCategoria">Filtrar por Categoría:</label>
              <select id="filtroCategoria"></select>
          </div>
      </div>

      <div class="card">
          <div class="table-container">
              <table id="tabla-consulta-productos">
                  <thead>
                      <tr>
                          <th>Producto</th>
                          <th class="sortable" data-sort="categoria">Categoría <i data-lucide="arrow-down-up" class="sort-icon"></i></th>
                          <th>Disponibles</th>
                          <th>Precio Compra</th>
                          <th class="sortable" data-sort="subtotal">Subtotal <i data-lucide="arrow-down-up" class="sort-icon"></i></th>
                          <th>Código Barras</th>
                      </tr>
                  </thead>
                  <tbody>
                      </tbody>
              </table>
          </div>
      </div>
    </section>

    <section class="tab-content" id="consulta-ventas-view">
      <div class="consulta-header">
          <h2><i data-lucide="history"></i> Consulta de Historial de Ventas</h2>
          <button class="option-btn" id="btn-volver-consultas-desde-ventas"><i data-lucide="arrow-left"></i> Volver</button>
      </div>

      <div class="card card-filtros">
          <div class="filtro-item">
              <label for="filtro-fecha-inicio">Desde:</label>
              <input type="date" id="filtro-fecha-inicio">
          </div>
          <div class="filtro-item">
              <label for="filtro-fecha-fin">Hasta:</label>
              <input type="date" id="filtro-fecha-fin">
          </div>
          <div class="filtro-item">
              <label for="filtro-cliente">Cliente:</label>
              <select id="filtro-cliente"></select>
          </div>
          <div class="filtro-item">
              <label for="filtro-producto">Producto:</label>
              <select id="filtro-producto"></select>
          </div>
      </div>

      <div class="card">
          <div class="table-container">
              <table id="tabla-consulta-ventas">
                  <thead>
                      <tr>
                          <th>Fecha</th>
                          <th>Cliente</th>
                          <th>Producto</th>
                          <th>Cant.</th>
                          <th>P. Unitario</th>
                          <th>Subtotal</th>
                      </tr>
                  </thead>
                  <tbody>
                      </tbody>
              </table>
          </div>
          <div class="table-summary">
              <strong>Total de Ventas (filtrado):</strong>
              <span id="total-ventas-filtradas">$0.00</span>
          </div>
      </div>
    </section>

  </main>

  <div id="modalProducto" class="modal hidden">
    <div class="modal-content">
      <h2>Agregar Producto</h2>
      <form id="formProducto">
        <label>Producto:</label>
        <select name="producto_id" id="selectProducto" required></select>
        <div id="nombreProductoSeleccionado" class="hidden" style="margin-top: 10px;">
            <label>Nombre del Producto:</label>
            <p id="textoNombreProducto" style="font-weight: bold; margin: 5px 0 0 0; padding: 8px; background-color: #f0f0f0; border-radius: 4px;"></p>
        </div>
        <div id="camposNuevoProducto" class="hidden">
          <label>Nombre del Nuevo Producto:</label>
          <input type="text" name="nombre_producto" />
          <label>Categoría:</label>
          <select name="categoria_id" id="selectCategoria"></select>
          <div id="campoNuevaCategoria" class="hidden">
            <label>Nombre de la Nueva Categoría:</label>
            <input type="text" name="nombre_categoria" />
          </div>
        </div>
        <label>Código de Barras:</label>
        <input type="text" name="codigo_barras" id="inputCodigoBarras" />
        <label>Precio de Compra:</label>
        <input type="number" name="precio_compra" step="0.01" required />
        <label>Unidades Adquiridas:</label>
        <input type="number" name="unidades" required />
        <div class="modal-actions">
          <button type="submit" class="option-btn"><i data-lucide="check"></i> Guardar</button>
          <button type="button" id="closeModal" class="option-btn danger"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalCliente" class="modal hidden">
    <div class="modal-content">
      <h2>Agregar Cliente</h2>
      <form id="formCliente">
        <label>Nombre del Cliente:</label>
        <input type="text" name="nombre" required />
        <label>Teléfono (Opcional):</label>
        <input type="text" name="telefono" placeholder="Ej: 3312345678" />
        <label>Domicilio (Opcional):</label>
        <input type="text" name="domicilio" placeholder="Ej: Calle 1 #123, Colonia" />
        <div class="modal-actions">
          <button type="submit" class="option-btn"><i data-lucide="check"></i> Guardar</button>
          <button type="button" id="closeModalCliente" class="option-btn danger"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalAbono" class="modal hidden">
    <div class="modal-content">
      <h2>Agregar Abono</h2>
      <form id="formAbono">
        <label>Cliente:</label>
        <select name="cliente_id" id="selectClienteAbono" required></select>
        <label>Fecha del Abono:</label>
        <input type="date" name="fecha_abono" required />
        <label>Monto del Abono:</label>
        <input type="number" name="monto_abono" step="0.01" placeholder="Ej: 150.00" required />
        <div class="modal-actions">
          <button type="submit" class="option-btn"><i data-lucide="check"></i> Guardar Abono</button>
          <button type="button" id="closeModalAbono" class="option-btn danger"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalVenta" class="modal hidden">
    <div class="modal-content">
      <h2>Agregar Venta</h2>
      <form id="formVenta">
        <label>Producto:</label>
        <select name="producto_id" id="selectProductoVenta" required></select>
        <label>Precio de Compra (Referencia):</label>
        <input type="number" id="precio_compra_venta" step="0.01" readonly style="background-color: #f0f0f0;"/>
        <label>Precio de Venta (Unitario):</label>
        <input type="number" name="precio_unitario" step="0.01" required />
        <label>Cantidad a Vender:</label>
        <input type="number" name="cantidad" required />
        <label>Cliente:</label>
        <select name="cliente_id" id="selectClienteVenta" required></select>
        <label>Fecha de Venta:</label>
        <input type="date" name="fecha_venta" required />
        <div class="modal-actions">
          <button type="submit" class="option-btn"><i data-lucide="check"></i> Registrar Venta</button>
          <button type="button" id="closeModalVenta" class="option-btn danger"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalDeleteAbono" class="modal hidden">
    <div class="modal-content">
      <h2>Eliminar Abono</h2>
      <form id="formDeleteAbono">
        <label>Selecciona un Abono:</label>
        <select name="abono_id" id="selectDeleteAbono" required></select>
        <div class="modal-actions">
          <button type="submit" class="option-btn danger"><i data-lucide="trash-2"></i> Eliminar</button>
          <button type="button" id="closeModalDeleteAbono" class="option-btn"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalDeleteProducto" class="modal hidden">
    <div class="modal-content">
      <h2>Eliminar Producto</h2>
      <form id="formDeleteProducto">
        <label>Selecciona un Producto:</label>
        <select name="producto_id" id="selectDeleteProducto" required></select>
        <div class="modal-actions">
          <button type="submit" class="option-btn danger">
            <i data-lucide="trash-2"></i> Eliminar
          </button>
          <button type="button" id="closeModalDeleteProducto" class="option-btn">
            <i data-lucide="x"></i> Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalDeleteVenta" class="modal hidden">
    <div class="modal-content">
      <h2>Eliminar Venta</h2>
      <form id="formDeleteVenta">
        <label>Selecciona una Venta:</label>
        <select name="venta_id" id="selectDeleteVenta" required></select>
        <div class="modal-actions">
          <button type="submit" class="option-btn danger"><i data-lucide="trash-2"></i> Eliminar</button>
          <button type="button" id="closeModalDeleteVenta" class="option-btn"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalDeleteCliente" class="modal hidden">
    <div class="modal-content">
      <h2>Eliminar Cliente</h2>
      <form id="formDeleteCliente">
        <label for="selectDeleteCliente">Selecciona un cliente:</label>
        <select id="selectDeleteCliente" required>
          <option value="">-- Cargando clientes --</option>
        </select>
        <div class="modal-actions">
          <button type="submit" class="option-btn danger">
            <i data-lucide="trash-2"></i> Eliminar
          </button>
          <button type="button" id="cancelDeleteCliente" class="option-btn">
            <i data-lucide="x"></i> Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalModificarCliente" class="modal hidden">
    <div class="modal-content">
        <h2>Modificar Cliente</h2>
        <form id="formModificarCliente">
            <label>Selecciona el cliente a modificar:</label>
            <select name="cliente_id" id="selectModificarCliente" required></select>
            
            <div id="camposModificarCliente" class="hidden">
                <label>Nombre del Cliente:</label>
                <input type="text" name="nombre" required />
                <label>Teléfono:</label>
                <input type="text" name="telefono" />
                <label>Domicilio:</label>
                <input type="text" name="domicilio" />
            </div>
            <div class="modal-actions">
                <button type="submit" class="option-btn warning"><i data-lucide="save"></i> Guardar Cambios</button>
                <button type="button" class="close-modal option-btn danger"><i data-lucide="x"></i> Cancelar</button>
            </div>
        </form>
    </div>
  </div>

  <div id="modalModificarAbono" class="modal hidden">
    <div class="modal-content">
        <h2>Modificar Abono</h2>
        <form id="formModificarAbono">
            <label>Selecciona el abono a modificar:</label>
            <select name="abono_id" id="selectModificarAbono" required></select>
            
            <div id="camposModificarAbono" class="hidden">
                <label>Fecha del Abono:</label>
                <input type="date" name="fecha_abono" required />
                <label>Monto del Abono:</label>
                <input type="number" step="0.01" name="monto_abono" required />
            </div>

            <div class="modal-actions">
                <button type="submit" class="option-btn warning">
                    <i data-lucide="save"></i> Guardar Cambios
                </button>
                <button type="button" class="close-modal option-btn danger">
                    <i data-lucide="x"></i> Cancelar
                </button>
            </div>
        </form>
    </div>
  </div>

  <div id="modalModificarProducto" class="modal hidden">
    <div class="modal-content">
      <h2>Modificar Producto</h2>
      <form id="formModificarProducto">
        <label>Selecciona el producto a modificar:</label>
        <select name="producto_id" id="selectModificarProducto" required></select>
        
        <div id="camposModificarProducto" class="hidden">
          <label>Nombre del Producto:</label>
          <input type="text" name="nombre_producto" required />

          <label>Código de Barras:</label>
          <input type="text" name="codigo_barras" />

          <label>Categoría:</label>
          <select name="categoria_id" id="selectCategoriaModificar"></select>

          <label>Precio de Compra:</label>
          <input type="number" step="0.01" name="precio_compra" required />

          <label>Unidades Disponibles:</label>
          <input type="number" name="unidades_disponibles" required />
        </div>

        <div class="modal-actions">
          <button type="submit" class="option-btn warning"><i data-lucide="save"></i> Guardar Cambios</button>
          <button type="button" class="close-modal option-btn danger"><i data-lucide="x"></i> Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalModificarVenta" class="modal hidden">
    <div class="modal-content">
      <h2>Modificar Venta</h2>
      <form id="formModificarVenta">
        <label>Selecciona la venta a modificar:</label>
        <select name="venta_id" id="selectModificarVenta" required></select>

        <div id="camposModificarVenta" class="hidden">
          <label>Producto:</label>
          <select name="producto_id" id="selectProductoModificarVenta" required></select>

          <label>Cliente:</label>
          <select name="cliente_id" id="selectClienteModificarVenta" required></select>

          <label>Fecha de Venta:</label>
          <input type="date" name="fecha_venta" required />

          <label>Cantidad:</label>
          <input type="number" name="cantidad" id="cantidadModificarVenta" min="1" required />

          <label>Precio Unitario:</label>
          <input type="number" step="0.01" name="precio_unitario" id="precioModificarVenta" required />

          <label>Subtotal:</label>
          <input type="number" step="0.01" name="subtotal" id="subtotalModificarVenta" readonly />
        </div>

        <div class="modal-actions">
          <button type="submit" class="option-btn warning">
            <i data-lucide="save"></i> Guardar Cambios
          </button>
          <button type="button" class="close-modal option-btn danger">
            <i data-lucide="x"></i> Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalBarcodeAction" class="modal hidden">
    <div class="modal-content">
      <h2>Código de Barras Detectado</h2>
      <p>¿Qué deseas hacer con este producto?</p>
      <div class="modal-actions" style="justify-content: center;">
        <button type="button" id="barcodeActionVenta" class="option-btn"><i data-lucide="shopping-cart"></i> Registrar Venta</button>
        <button type="button" id="barcodeActionProducto" class="option-btn"><i data-lucide="package-plus"></i> Registrar/Actualizar Producto</button>
        <button type="button" class="close-modal option-btn danger"><i data-lucide="x"></i> Cancelar</button>
      </div>
    </div>
  </div>

  <div id="modalWhatsappSelection" class="modal hidden">
    <div class="modal-content" style="width: 500px; max-width: 95%;">
      <h2>Seleccionar Clientes para Enviar Saldo</h2>
      <div id="whatsapp-client-list" style="max-height: 40vh; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #eee; padding: 10px; border-radius: 8px;">
        <p>Cargando clientes con saldo pendiente...</p>
      </div>
      <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 1.5rem;">
        <input type="checkbox" id="whatsapp-select-all" style="width: auto;">
        <label for="whatsapp-select-all" style="margin-bottom: 0;">Seleccionar todos</label>
      </div>
      <div class="modal-actions">
        <button type="button" id="generateWhatsappMessages" class="option-btn" style="background-color: #25D366; color: white; border-color: #25D366;"><i data-lucide="send"></i> Generar Mensajes</button>
        <button type="button" id="closeWhatsappSelectionModal" class="option-btn danger"><i data-lucide="x"></i> Cancelar</button>
      </div>
    </div>
  </div>

  <div id="modalWhatsappSender" class="modal hidden">
    <div class="modal-content" style="width: 600px; max-width: 95%;">
      <h2>Enviar Mensajes de WhatsApp</h2>
      <div class="table-container" style="max-height: 50vh;">
        <table id="whatsapp-sender-table">
          <thead>
            <tr>
              <th>Cliente</th>
              <th>Acción</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody>
            </tbody>
        </table>
      </div>
      <div class="modal-actions" style="justify-content: flex-end;">
        <button type="button" id="closeWhatsappSenderModal" class="option-btn"><i data-lucide="check"></i> Finalizar</button>
      </div>
    </div>
  </div>

  
  <script src="script.js" defer></script>
</body>
</html>